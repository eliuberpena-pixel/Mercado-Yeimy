<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda Funcional</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .hidden {
            display: none;
        }
        
        /* LOGIN */
        .login-box {
            max-width: 400px;
            margin: 50px auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        .login-box h1 {
            text-align: center;
            margin-bottom: 30px;
        }
        
        input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        button {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .link {
            text-align: center;
            margin-top: 20px;
            color: #007bff;
            cursor: pointer;
        }
        
        /* TIENDA */
        .header {
            background: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .tab-btn {
            padding: 10px 20px;
            background: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .tab-btn.active {
            background: #007bff;
            color: white;
        }
        
        .content {
            background: white;
            padding: 20px;
            border-radius: 5px;
            min-height: 300px;
        }
        
        .producto {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
    </style>
</head>
<body>

<!-- LOGIN -->
<div id="login">
    <div class="login-box">
        <h1>Tienda Online</h1>
        <input type="text" id="usuario" placeholder="Usuario">
        <input type="password" id="password" placeholder="Contraseña">
        <button onclick="hacerLogin()">Entrar</button>
        <div class="link" onclick="mostrarRegistro()">Crear cuenta nueva</div>
    </div>
</div>

<!-- REGISTRO -->
<div id="registro" class="hidden">
    <div class="login-box">
        <h1>Crear Cuenta</h1>
        <input type="text" id="nuevoNombre" placeholder="Nombre">
        <input type="text" id="nuevoUsuario" placeholder="Usuario">
        <input type="password" id="nuevaPassword" placeholder="Contraseña">
        <button onclick="crearCuenta()">Crear Cuenta</button>
        <div class="link" onclick="mostrarLogin()">Volver al login</div>
    </div>
</div>

<!-- TIENDA -->
<div id="tienda" class="hidden">
    <!-- HEADER -->
    <div class="header">
        <h2>Mi Tienda</h2>
        <div>
            <span id="saludo">Usuario</span>
            <button onclick="cerrarSesion()" style="width: auto; margin-left: 10px;">Salir</button>
        </div>
    </div>
    
    <!-- TABS -->
    <div class="tabs">
        <button class="tab-btn active" onclick="mostrarSeccion('productos')">Productos</button>
        <button class="tab-btn" onclick="mostrarSeccion('carrito')">Carrito</button>
        <button class="tab-btn" onclick="mostrarSeccion('perfil')">Perfil</button>
        <button class="tab-btn" onclick="mostrarSeccion('ajustes')">Ajustes</button>
    </div>
    
    <!-- CONTENIDO -->
    <div class="content">
        <!-- PRODUCTOS -->
        <div id="seccion-productos">
            <h3>Productos</h3>
            <div class="producto">
                <h4>Café Americano</h4>
                <p>Precio: $2.50</p>
                <button onclick="agregarAlCarrito('Café Americano', 2.50)">Agregar</button>
            </div>
            <div class="producto">
                <h4>Capuccino</h4>
                <p>Precio: $3.00</p>
                <button onclick="agregarAlCarrito('Capuccino', 3.00)">Agregar</button>
            </div>
        </div>
        
        <!-- CARRITO -->
        <div id="seccion-carrito" class="hidden">
            <h3>Carrito</h3>
            <div id="carrito-items">
                <p>Carrito vacío</p>
            </div>
            <div style="margin-top: 20px;">
                <h4>Total: $<span id="total">0</span></h4>
                <button onclick="hacerPedido()">Comprar</button>
            </div>
        </div>
        
        <!-- PERFIL -->
        <div id="seccion-perfil" class="hidden">
            <h3>Mi Perfil</h3>
            <input type="text" id="editNombre" placeholder="Nombre">
            <input type="password" id="editPassword" placeholder="Nueva contraseña">
            <button onclick="actualizarPerfil()">Guardar</button>
        </div>
        
        <!-- AJUSTES -->
        <div id="seccion-ajustes" class="hidden">
            <h3>Ajustes</h3>
            <input type="text" id="tiendaNombre" placeholder="Nombre tienda">
            <button onclick="guardarAjustes()">Guardar</button>
        </div>
    </div>
</div>

<script>
// ===================================
// VARIABLES
// ===================================
let usuarioActual = null;
let carrito = [];

// ===================================
// FUNCIONES DE PANTALLA
// ===================================
function mostrarLogin() {
    document.getElementById('registro').classList.add('hidden');
    document.getElementById('login').classList.remove('hidden');
}

function mostrarRegistro() {
    document.getElementById('login').classList.add('hidden');
    document.getElementById('registro').classList.remove('hidden');
}

// ===================================
// LOGIN
// ===================================
function hacerLogin() {
    const user = document.getElementById('usuario').value;
    const pass = document.getElementById('password').value;
    
    // ADMIN por defecto
    if (user === "admin" && pass === "0012") {
        usuarioActual = {
            nombre: "Administrador",
            tipo: "admin"
        };
        iniciarTienda();
        return;
    }
    
    // Cualquier otro usuario
    if (user && pass) {
        usuarioActual = {
            nombre: user,
            tipo: "cliente"
        };
        iniciarTienda();
    } else {
        alert("Ingresa usuario y contraseña");
    }
}

function crearCuenta() {
    const nombre = document.getElementById('nuevoNombre').value;
    const user = document.getElementById('nuevoUsuario').value;
    const pass = document.getElementById('nuevaPassword').value;
    
    if (nombre && user && pass) {
        usuarioActual = {
            nombre: nombre,
            tipo: "cliente"
        };
        iniciarTienda();
    } else {
        alert("Completa todos los campos");
    }
}

// ===================================
// TIENDA
// ===================================
function iniciarTienda() {
    console.log("Iniciando tienda para:", usuarioActual.nombre);
    
    // Ocultar login/registro
    document.getElementById('login').classList.add('hidden');
    document.getElementById('registro').classList.add('hidden');
    
    // Mostrar tienda
    document.getElementById('tienda').classList.remove('hidden');
    
    // Mostrar saludo
    document.getElementById('saludo').textContent = "Hola, " + usuarioActual.nombre;
    
    // Cargar perfil
    document.getElementById('editNombre').value = usuarioActual.nombre;
}

function cerrarSesion() {
    if (confirm("¿Cerrar sesión?")) {
        usuarioActual = null;
        carrito = [];
        document.getElementById('tienda').classList.add('hidden');
        document.getElementById('login').classList.remove('hidden');
        document.getElementById('usuario').value = "";
        document.getElementById('password').value = "";
    }
}

// ===================================
// NAVEGACIÓN
// ===================================
function mostrarSeccion(seccion) {
    console.log("Mostrando sección:", seccion);
    
    // Ocultar todas
    document.getElementById('seccion-productos').classList.add('hidden');
    document.getElementById('seccion-carrito').classList.add('hidden');
    document.getElementById('seccion-perfil').classList.add('hidden');
    document.getElementById('seccion-ajustes').classList.add('hidden');
    
    // Remover activo
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    
    // Mostrar sección
    document.getElementById('seccion-' + seccion).classList.remove('hidden');
    
    // Marcar botón activo
    event.target.classList.add('active');
    
    // Si es carrito, actualizar
    if (seccion === 'carrito') {
        actualizarCarrito();
    }
}

// ===================================
// CARRITO
// ===================================
function agregarAlCarrito(nombre, precio) {
    carrito.push({
        nombre: nombre,
        precio: precio,
        cantidad: 1
    });
    
    alert("✅ " + nombre + " agregado al carrito");
    
    // Si estamos en carrito, actualizar
    if (!document.getElementById('seccion-carrito').classList.contains('hidden')) {
        actualizarCarrito();
    }
}

function actualizarCarrito() {
    const container = document.getElementById('carrito-items');
    const totalSpan = document.getElementById('total');
    
    if (carrito.length === 0) {
        container.innerHTML = '<p>Carrito vacío</p>';
        totalSpan.textContent = "0";
        return;
    }
    
    let total = 0;
    container.innerHTML = '';
    
    carrito.forEach((item, index) => {
        const subtotal = item.precio * item.cantidad;
        total += subtotal;
        
        const div = document.createElement('div');
        div.className = 'producto';
        div.innerHTML = `
            <div style="display: flex; justify-content: space-between;">
                <div>
                    <strong>${item.nombre}</strong><br>
                    $${item.precio} x ${item.cantidad}
                </div>
                <button onclick="eliminarDelCarrito(${index})" style="background: red; width: auto;">Eliminar</button>
            </div>
        `;
        container.appendChild(div);
    });
    
    totalSpan.textContent = total.toFixed(2);
}

function eliminarDelCarrito(index) {
    carrito.splice(index, 1);
    actualizarCarrito();
}

function hacerPedido() {
    if (carrito.length === 0) {
        alert("El carrito está vacío");
        return;
    }
    
    let total = 0;
    let mensaje = "Resumen del pedido:\n\n";
    
    carrito.forEach(item => {
        const subtotal = item.precio * item.cantidad;
        total += subtotal;
        mensaje += `${item.nombre} x${item.cantidad} - $${subtotal.toFixed(2)}\n`;
    });
    
    mensaje += `\nTotal: $${total.toFixed(2)}`;
    mensaje += `\nCliente: ${usuarioActual.nombre}`;
    
    alert("✅ Pedido realizado!\n\n" + mensaje);
    
    // Limpiar carrito
    carrito = [];
    actualizarCarrito();
}

// ===================================
// PERFIL
// ===================================
function actualizarPerfil() {
    const nuevoNombre = document.getElementById('editNombre').value;
    
    if (nuevoNombre) {
        usuarioActual.nombre = nuevoNombre;
        document.getElementById('saludo').textContent = "Hola, " + usuarioActual.nombre;
        alert("✅ Perfil actualizado");
    }
}

// ===================================
// AJUSTES
// ===================================
function guardarAjustes() {
    const nuevoNombre = document.getElementById('tiendaNombre').value;
    
    if (nuevoNombre) {
        document.querySelector('.header h2').textContent = nuevoNombre;
        alert("✅ Ajustes guardados");
    }
}

// ===================================
// INICIO
// ===================================
// Cuando se carga la página
window.onload = function() {
    console.log("✅ Página cargada correctamente");
    // Todo listo para usar
};
</script>
</body>
</html>
